<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Đăng nhập | Admin</title>
    <!-- plugins:css -->
    <link href="~/Resources/Admin/vendors/mdi/css/materialdesignicons.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/Resources/Admin/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="~/Resources/Admin/vendors/css/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="~/Resources/Admin/css/style.css">
    <!-- End layout styles -->
    <link rel="shortcut icon" href="~/Resources/Admin/images/fav.png" />
</head>
<body>
    <div class="container-scroller">
        <div class="container-fluid page-body-wrapper full-page-wrapper">
            <div class="content-wrapper d-flex align-items-center auth">
                <div class="row flex-grow">
                    <div class="col-lg-4 mx-auto">
                        <div class="auth-form-light text-left p-5">
                            <div class="brand-logo">
                                <img src="~/Resources/Client/img/logo.png">
                            </div>
                            <h3>Xin chào! </h3>
                            <h6 class="font-weight-light">Đăng nhập để tiếp tục.</h6>
                            <form class="pt-3">
                                <p id="error"></p>
                                <div class="form-group">
                                    <input type="email" class="form-control form-control-lg" id="username" placeholder="Tên đăng nhập">
                                </div>
                                <div class="form-group">
                                    <input type="password" class="form-control form-control-lg" id="password" placeholder="Mật khẩu">
                                </div>
                                <div class="mt-3">
                                    @*<a class="btn btn-block btn-gradient-primary btn-lg font-weight-medium auth-form-btn" href="../../index.html">SIGN IN</a>*@
                                    <btn id="btn_submit" class="btn btn-block btn-gradient-primary btn-lg font-weight-medium auth-form-btn">Đăng nhập</btn>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- content-wrapper ends -->
        </div>
        <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="~/Resources/Admin/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="~/Resources/Admin/js/off-canvas.js"></script>
    <script src="~/Resources/Admin/js/hoverable-collapse.js"></script>
    <script src="~/Resources/Admin/js/misc.js"></script>
    <!-- endinject -->

    <script type="text/javascript">
        $("#btn_submit").on("click", function () {
            var username = $("#username").val();
            var password = $("#password").val();
            var error = $("#error");
            var ok = $("#ok");

            // resert 2 thẻ div thông báo trở về rỗng mỗi khi click nút đăng nhập
            error.html("");
            ok.html("");

            // Kiểm tra nếu username rỗng thì báo lỗi
            if (username == "") {
                error.html("Tên đăng nhập không được để trống");
                return false;
            }
            // Kiểm tra nếu password rỗng thì báo lỗi
            if (password == "") {
                error.html("Mật khẩu không được để trống");
                return false;
            }

            // Chạy ajax gửi thông tin username và password về server check_dang_nhap.php
            // để kiểm tra thông tin đăng nhập hợp lệ hay chưa
            $.ajax({
                url: "/LoginSystem/Login",
                method: "POST",
                data: { username: username, password: password },
                success: function (json) {
                    
                    if (json.isRedirect == 100) {
                        debugger;
                        // Tài khoản đang trong quá trình bị Lock
                        alert(json.message+'. Vui lòng thực hiện gửi OTP sau thời gian này');
                    }
                    if (json.isRedirect ==1) {
                        window.location.href = json.redirectUrl;
                    }
                    if (json.isRedirect == -1) {
                        error.html("Tài khoản hoặc mật khẩu không chính xác! Vui lòng kiểm tra lại");
                    }
                }
            });

        });
        $("#username").on("click", function () {
            $("#error").html("");
           
        });
        $("#password").on("click", function () {
            $("#error").html("");

        });
    </script>
</body>
</html>

