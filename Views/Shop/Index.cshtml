@model Web.Models.ViewModels.ProductViewModel
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .zoom:hover {
        transform: scale(1.1); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
    }
</style>

@section banner{
    <section class="banner-area organic-breadcrumb">
        <div class="container">
            <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
                <div class="col-first">
                    <h1>Tất cả sản phẩm</h1>
                    <nav class="d-flex align-items-center">
                        <a href="/Home">Trang chủ<span class="lnr lnr-arrow-right"></span></a>
                        <a href="/Shop">Cửa hàng</a>
                    </nav>
                </div>
            </div>
        </div>
    </section>
}


@section product{
    <section class="owl-carousel" style="padding-bottom: 100px;padding-top: 100px;">
        <div class="container">

            <div class="row">
                <div class="col-xl-3 col-lg-4 col-md-5">
                    <div class="sidebar-categories">
                        <div class="head">Danh mục sản phẩm</div>
                        <ul class="main-categories">
                            @foreach (var item in Model.productTypes)
                            {
                                <li class="main-nav-list">
                                    <a class="nav-link" href="/Shop?IDProductType=@item.IDProductType">
                                        <span class="lnr lnr-arrow-right"></span>@item.NameProductType
                                    </a>
                                </li>
                            }
                        </ul>
                    </div>
                </div>
                <div class="col-xl-9 col-lg-8 col-md-7">
                    <!-- Start Filter Bar -->
                    <div class="filter-bar d-flex flex-wrap align-items-center">
                        <div class="sorting">
                            <select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
                                <option value="" selected>Chọn danh mục</option>
                                <option value="/Shop?IDProductType=0&show=@Model.show&page=@Model.CurrentPage&IDProducer=@Model.IDProducer">Tất cả danh mục</option>
                                @foreach (var item in Model.productTypes)
                                {
                                    <option value="/Shop?IDProductType=@item.IDProductType&show=@Model.show&page=@Model.CurrentPage&IDProducer=@Model.IDProducer">@item.NameProductType</option>
                                }
                            </select>
                        </div>
                        <div class="sorting">
                            <select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
                                <option value="" selected>Chọn hãng</option>
                                <option value="/Shop?IDProductType=@Model.IDProductType&show=@Model.show&page=@Model.CurrentPage&IDProducer=0">Tất cả hãng</option>
                                @foreach (var item in Model.producers)
                                {
                                    <option value="/Shop?IDProductType=@Model.IDProductType&show=@Model.show&page=@Model.CurrentPage&IDProducer=@item.IDProducer">@item.NameProducer</option>
                                }
                            </select>
                        </div>
                        <div class="sorting mr-auto">
                            <select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
                                <option value="" selected>Hiển thị...</option>
                                <option value="/Shop?IDProductType=@Model.IDProductType&show=6&page=@Model.CurrentPage&IDProducer=@Model.IDProducer">Hiển thị 6</option>
                                <option value="/Shop?IDProductType=@Model.IDProductType&show=9&page=@Model.CurrentPage&IDProducer=@Model.IDProducer">Hiển thị 9</option>
                                <option value="/Shop?IDProductType=@Model.IDProductType&show=12&page=@Model.CurrentPage&IDProducer=@Model.IDProducer">Hiển thị 12</option>
                            </select>
                        </div>
                        <div class="pagination">
                            @for (int i = 1; i <= Model.PageCount(); i++)
                            {
                                <a href="/Shop?IDProductType=@Model.IDProductType&IDProducer=@Model.IDProducer&show=@Model.show&page=@i"
                                   class="@(i == Model.CurrentPage ? "page-item active" : "page-item")">@i</a>
                            }
                        </div>
                    </div>
                    <!-- End Filter Bar -->
                    <!-- Start Best Seller -->
                    <section class="lattest-product-area pb-40 category-list">
                        <div class="row">
                            @foreach (var item in Model.PaginatedBlogs())
                            {
                                <!-- single product -->
                                <div class="col-lg-4 col-md-6">
                                    <div class="single-product zoom">
                                        <img class="img-fluid lazy" data-src=@Url.Content("~/App_Img/product/" + @item.Image0)>
                                        @*<img onclick="location.href='@Url.Action("Details", "Shop", new { id = @item.IDProduct})'"
                                            class="img-fluid" src=@Url.Content("~/App_Img/product/" + @item.Image0) alt="">*@
                                        <div class="product-details">
                                            <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @item.IDProduct})'">
                                                <h6>
                                                    @item.NameProduct
                                                </h6>
                                            </a>
                                            <div class="price">
                                                <h5> @String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", @item.Price) ₫</h5>
                                                <h6 class="l-through">@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", (@item.Price + 200000)) ₫</h6>
                                            </div>
                                            <div class="prd-bottom">

                                                <a class="social-info btn_submit" data-id="@item.IDProduct">
                                                    <span class="ti-bag"></span>
                                                    <p class="hover-text">Thêm vào giỏ hàng</p>
                                                </a>
                                                <a href="" class="social-info btn_AddListWish" data-id="@item.IDProduct">
                                                    <span class="lnr lnr-heart"></span>
                                                    <p class="hover-text">Yêu thích</p>
                                                </a>
                                                <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @item.IDProduct})'" class="social-info">
                                                    <span class="lnr lnr-move"></span>
                                                    <p class="hover-text">Chi tiết</p>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </section>
                    <!-- End Best Seller -->
                    <!-- Start Filter Bar -->
                    <div class="filter-bar d-flex flex-wrap align-items-center">
                        <div class="sorting mr-auto">
                            <select onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">
                                <option value="" selected>Hiển thị...</option>
                                <option value="/Shop?IDProductType=@Model.IDProductType&IDProducer=@Model.IDProducer&show=6&page=@Model.CurrentPage">Hiển thị 6</option>
                                <option value="/Shop?IDProductType=@Model.IDProductType&IDProducer=@Model.IDProducer&show=9&page=@Model.CurrentPage">Hiển thị 9</option>
                                <option value="/Shop?IDProductType=@Model.IDProductType&IDProducer=@Model.IDProducer&show=12&page=@Model.CurrentPage">Hiển thị 12</option>
                            </select>
                        </div>
                        <div class="pagination">
                            @for (int i = 1; i <= Model.PageCount(); i++)
                            {
                                <a href="/Shop?IDProductType=@Model.IDProductType&IDProducer=@Model.IDProducer&show=@Model.show&page=@i"
                                   class="@(i == Model.CurrentPage ? "page-item active" : "page-item")">@i</a>
                            }
                        </div>
                    </div>
                    <!-- End Filter Bar -->
                </div>
            </div>
        </div>


    </section>
}
<script>
    $(".btn_submit").on("click", function () {
        //var IdProduct = $("#MyId").val();
        var IdProduct = $(this).data('id');
        var Amount = 1;
        $.ajax({
            url: "/Shop/AddToCart",
            method: "POST",
            data: { IdProduct: IdProduct, Amount: Amount },
            success: function (json) {
                if (json.status) {
                    var x = json.TotalMoney1;
                    var y = json.Quanlity1;
                    document.getElementById("Total1").innerHTML = json.TotalMoney1;
                    document.getElementById("Count").innerHTML = json.Quanlity1;
                }
                else {
                    //alert('Bạn đã thêm sản phẩm vào giỏ hàng thành công');
                }
            }
        });

    });
    // Nút thêm sản phẩm vào mục ưa thích
    $(".btn_AddListWish").on("click", function () {
        //var IdProduct = $("#MyId").val();
        var IdProduct = $(this).data('id');
        $.ajax({
            url: "/Shop/AddListWish",
            method: "POST",
            data: { IdProduct: IdProduct },
            success: function (json) {
                if (json.status) {
                    alert("Bạn đã thêm sản phẩm vào mục ưa thích");
                }
                else {
                    alert(json.mess);
                }
            }
        });
    });
    document.addEventListener("DOMContentLoaded", function() {
    var lazyloadImages = document.querySelectorAll("img.lazy");    
    var lazyloadThrottleTimeout;
    
    function lazyload () {
      if(lazyloadThrottleTimeout) {
        clearTimeout(lazyloadThrottleTimeout);
      }    
      
      lazyloadThrottleTimeout = setTimeout(function() {
          var scrollTop = window.pageYOffset;
          lazyloadImages.forEach(function(img) {
              if(img.offsetTop < (window.innerHeight + scrollTop)) {
                img.src = img.dataset.src;
                img.classList.remove('lazy');
              }
          });
          if(lazyloadImages.length == 0) { 
            document.removeEventListener("scroll", lazyload);
            window.removeEventListener("resize", lazyload);
            window.removeEventListener("orientationChange", lazyload);
          }
      }, 200);
    }
    
    document.addEventListener("scroll", lazyload);
    window.addEventListener("resize", lazyload);
    window.addEventListener("orientationChange", lazyload);
  });
</script>
