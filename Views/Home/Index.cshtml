@model Web.Models.ViewModels.HomeVM

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

    <style>
        .zoom:hover {
            transform: scale(1.05); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
        }
    </style>        

@section banner{
    <section class="banner-area">
        <div class="container">
            <div class="row fullscreen align-items-center justify-content-start">
                <div class="col-lg-12">
                    <div class="active-banner-slider owl-carousel">
                        @if (Model.products.Count() > 4)
                        {
                            for (int i = 0; i < 5; i++)
                            {
                                <div class="row single-slide">
                                    <div class="col-lg-5">
                                        <div class="banner-content">
                                            <h1>@Model.products.ElementAtOrDefault(i).NameProduct</h1>

                                            <p>
                                                @Model.products.ElementAtOrDefault(i).Introduce
                                            </p>
                                            <div class="add-bag d-flex align-items-center">
                                                <a class="add-btn btn_submit" data-id="@Model.products.ElementAtOrDefault(i).IDProduct"><span class="lnr lnr-cross"></span></a>
                                                <span class="add-text text-uppercase">Thêm vào giỏ hàng</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-7">
                                        <div class="banner-img">
                                            <img class="img-fluid" src=@Url.Content("~/App_Img/product/" + @Model.products.ElementAtOrDefault(i).Image0) alt="">
                                        </div>
                                    </div>
                                </div>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
    </section>
}

@section features{
    <section class="features-area section_gap">
        <div class="container">
            <div class="row features-inner">
                <!-- single features -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="single-features">
                        <div class="f-icon">
                            @*<img src="~/Resources/Client/img/features/f-icon1.png" alt="">*@
                            <img src="~/App_Img/GIFAnimation/shipped.gif" />
                        </div>
                        <h6>Miễn phí vận chuyển</h6>
                        <p>Tất cả đơn hàng đều miễn phí</p>
                    </div>
                </div>
                <!-- single features -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="single-features">
                        <div class="f-icon">
                            @*<img src="~/Resources/Client/img/features/f-icon2.png" alt="">*@
                            <img src="~/App_Img/GIFAnimation/spinning-arrows.gif" />
                        </div>
                        <h6>Chính sách hoàn trả</h6>
                        <p>Tìm hiểu thêm</p>
                    </div>
                </div>
                <!-- single features -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="single-features">
                        <div class="f-icon">
                            @*<img src="~/Resources/Client/img/features/f-icon3.png" alt="">*@
                            <img src="~/App_Img/GIFAnimation/whatsapp-shake.gif" />
                        </div>
                        <h6>24/7 Hỗ trợ</h6>
                        <p>Sẵn sàng hỗ trợ</p>
                    </div>
                </div>
                <!-- single features -->
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="single-features">
                        <div class="f-icon">
                            @*<img src="~/Resources/Client/img/features/f-icon4.png" alt="">*@
                            <img src="~/App_Img/GIFAnimation/shopping.gif" />
                        </div>
                        <h6>Thanh toán khi nhận hàng</h6>
                        <p>An toàn khi thanh toán</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
}

@section Product{
    <section class="owl-carousel active-product-area section_gap">
        <!-- single product slide -->
        <div class="single-product-slider">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-6 text-center">
                        <div class="section-title">
                            <h1>Sản phẩm mới nhất</h1>
                            <p>
                                KarmaShop liên tục cập nhập những mẫu giày mới nhất chính hãng
                                phù hợp thời trang và đa dạng mẫu mã.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    @if (Model.products.Count() < 8)
                    {
                        for (int i = 0; i < Model.products.Count(); i++)
                        {
                            <!-- single product -->
                            <div class="col-lg-3 col-md-6">
                                <div class="single-product zoom">
                                    <img class="img-fluid lazy zoom" data-src=@Url.Content("~/App_Img/product/" + @Model.products.ElementAtOrDefault(i).Image0)>
                                    @*<img class="img-fluid zoom" src=@Url.Content("~/App_Img/product/" + @Model.products.ElementAtOrDefault(i).Image0) alt="">*@
                                    <div class="product-details">
                                        <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'">
                                            <h6>
                                                @Model.products.ElementAtOrDefault(i).NameProduct
                                            </h6>
                                        </a>
                                        <div class="price">
                                            <h5> @String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", @Model.products.ElementAtOrDefault(i).Price) ₫</h5>
                                            <h6 class="l-through">@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", (@Model.products.ElementAtOrDefault(i).Price + 200000)) ₫</h6>
                                        </div>
                                        <div class="prd-bottom">
                                            <a class="social-info btn_submit" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="ti-bag"></span>
                                                <p class="hover-text">Thêm vào giỏ hàng</p>
                                            </a>
                                            <a class="social-info btn_AddListWish" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="lnr lnr-heart"></span>
                                                <p class="hover-text">Yêu thích</p>
                                            </a>
                                            <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'" class="social-info">
                                                <span class="lnr lnr-move"></span>
                                                <p class="hover-text">Chi tiết</p>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        for (int i = 0; i < 8; i++)
                        {
                            <!-- single product -->
                            <div class="col-lg-3 col-md-6">
                                <div class="single-product zoom">
                                    <img class="img-fluid lazy zoom" data-src=@Url.Content("~/App_Img/product/" + @Model.products.ElementAtOrDefault(i).Image0)>
                                    <div class="product-details">
                                        <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'">
                                            <h6>
                                                @Model.products.ElementAtOrDefault(i).NameProduct
                                            </h6>
                                        </a>
                                        <div class="price">
                                            <h5> @String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", @Model.products.ElementAtOrDefault(i).Price) ₫</h5>
                                            <h6 class="l-through">@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", (@Model.products.ElementAtOrDefault(i).Price + 200000)) ₫</h6>
                                        </div>
                                        <div class="prd-bottom">
                                            <a class="social-info btn_submit" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="ti-bag"></span>
                                                <p class="hover-text">Thêm vào giỏ hàng</p>
                                            </a>
                                            <a class="social-info btn_AddListWish" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="lnr lnr-heart"></span>
                                                <p class="hover-text">Yêu thích</p>
                                            </a>
                                            <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'" class="social-info">
                                                <span class="lnr lnr-move"></span>
                                                <p class="hover-text">Chi tiết</p>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>

        <!-- single product slide -->
        <div class="single-product-slider">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-6 text-center">
                        <div class="section-title">
                            <h1>Nhiều sản phẩm hơn</h1>
                            <p>
                                KarmaShop liên tục cập nhập những mẫu giày mới nhất chính hãng
                                phù hợp thời trang và đa dạng mẫu mã.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    @if (8 < Model.products.Count() && Model.products.Count() < 16)
                    {
                        for (int i = 8; i < Model.products.Count(); i++)
                        {
                            <!-- single product -->
                            <div class="col-lg-3 col-md-6">
                                <div class="single-product zoom">
                                    <img class="img-fluid lazy zoom" data-src=@Url.Content("~/App_Img/product/" + @Model.products.ElementAtOrDefault(i).Image0)>
                                    <div class="product-details">
                                        <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'">
                                            <h6>
                                                @Model.products.ElementAtOrDefault(i).NameProduct
                                            </h6>
                                        </a>
                                        <div class="price">
                                            <h5> @String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", @Model.products.ElementAtOrDefault(i).Price) ₫</h5>
                                            <h6 class="l-through">@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", (@Model.products.ElementAtOrDefault(i).Price + 200000)) ₫</h6>
                                        </div>
                                        <div class="prd-bottom">
                                            <a class="social-info btn_submit" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="ti-bag"></span>
                                                <p class="hover-text">Thêm vào giỏ hàng</p>
                                            </a>
                                            <a class="social-info btn_AddListWish" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="lnr lnr-heart"></span>
                                                <p class="hover-text">Yêu thích</p>
                                            </a>
                                            <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'" class="social-info">
                                                <span class="lnr lnr-move"></span>
                                                <p class="hover-text">Chi tiết</p>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                    else if (Model.products.Count() > 8)
                    {
                        for (int i = 8; i < 16; i++)
                        {
                            <!-- single product -->
                            <div class="col-lg-3 col-md-6">
                                <div class="single-product zoom">
                                    <img class="img-fluid zoom lazy" data-src=@Url.Content("~/App_Img/product/" + @Model.products.ElementAtOrDefault(i).Image0)>
                                    <div class="product-details">
                                        <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'">
                                            <h6>
                                                @Model.products.ElementAtOrDefault(i).NameProduct
                                            </h6>
                                        </a>
                                        <div class="price">
                                            <h5> @String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", @Model.products.ElementAtOrDefault(i).Price) ₫</h5>
                                            <h6 class="l-through">@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", (@Model.products.ElementAtOrDefault(i).Price + 200000)) ₫</h6>
                                        </div>
                                        <div class="prd-bottom">
                                            <a class="social-info btn_submit" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="ti-bag"></span>
                                                <p class="hover-text">Thêm vào giỏ hàng</p>
                                            </a>
                                            <a class="social-info btn_AddListWish" data-id="@Model.products.ElementAtOrDefault(i).IDProduct">
                                                <span class="lnr lnr-heart"></span>
                                                <p class="hover-text">Yêu thích</p>
                                            </a>
                                            <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.products.ElementAtOrDefault(i).IDProduct})'" class="social-info">
                                                <span class="lnr lnr-move"></span>
                                                <p class="hover-text">Chi tiết</p>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    </section>

}

<!-- Start related-product Area -->
<section class="related-product-area section_gap_bottom">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 text-center">
                <div class="section-title">
                    <h1>Sản phẩm bán chạy nhất</h1>
                    <p>
                        Mời các bạn cùng xem lại những sản phẩm bán chạy nhất của KarmaShop <br />
                        Bạn yêu thích sản phẩm nào?
                    </p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-9">
                <div class="row">
                    @if (Model.deals.Count < 9)
                    {
                        foreach (var item in Model.deals)
                        {
                            <div class="col-lg-4 col-md-4 col-sm-6">
                                <div class="single-related-product d-flex">
                                    <a href="#"><img class="lazy" style="height:80px;" data-src=@Url.Content("~/App_Img/product/" + item.Image)></a>
                                    <div class="desc">
                                        <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = item.IDProduct})'" class="title">@item.NameProduct</a>
                                        <div class="price">
                                            <h6>@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", item.Price) ₫</h6>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        for (int i = 0; i < 9; i++)
                        {
                            <div class="col-lg-4 col-md-4 col-sm-6">
                                <div class="single-related-product d-flex">
                                    <a href="#"><img class="lazy" style="height:80px;" data-src=@Url.Content("~/App_Img/product/" + @Model.deals.ElementAtOrDefault(i).Image)></a>
                                    <div class="desc">
                                        <a href="#" onclick="location.href='@Url.Action("Details", "Shop", new { id = @Model.deals.ElementAtOrDefault(i).IDProduct})'" class="title">@Model.deals.ElementAtOrDefault(i).NameProduct</a>
                                        <div class="price">
                                            <h6>@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:N0}", Model.deals.ElementAtOrDefault(i).Price) ₫</h6>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }


                </div>
            </div>
            <div class="col-lg-3">
                <div class="ctg-right">
                    <a href="/Shop" target="_blank">
                        <img class="img-fluid d-block mx-auto lazy" data-src=@Url.Content("~/Resources/Client/img/category/c5.jpg") alt="">
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End related-product Area -->

<script>
    // Nút thêm sản phẩm vào giỏ hàng
    $(".btn_submit").on("click", function () {
        //var IdProduct = $("#MyId").val();
        var IdProduct = $(this).data('id');
        var Amount = 1;
        $.ajax({
            url: "/Shop/AddToCart",
            method: "POST",
            data: { IdProduct: IdProduct, Amount: Amount },
            success: function (json) {
                if (json.status) {
                    var x = json.TotalMoney1;
                    var y = json.Quanlity1;
                    document.getElementById("Total1").innerHTML = json.TotalMoney1;
                    document.getElementById("Count").innerHTML = json.Quanlity1;
                }
                else {
                    //alert('Bạn đã thêm sản phẩm vào giỏ hàng thành công');
                }
            }
        });

    });
    // Nút thêm sản phẩm vào mục ưa thích
    $(".btn_AddListWish").on("click", function () {
        //var IdProduct = $("#MyId").val();
        var IdProduct = $(this).data('id');
        $.ajax({
            url: "/Shop/AddListWish",
            method: "POST",
            data: { IdProduct: IdProduct },
            success: function (json) {
                if (json.status) {
                    alert("Bạn đã thêm sản phẩm vào mục ưa thích");
                }
                else {
                    alert(json.mess);
                }
            }
        });

    });
    document.addEventListener("DOMContentLoaded", function() {
    var lazyloadImages = document.querySelectorAll("img.lazy");    
    var lazyloadThrottleTimeout;
    
    function lazyload () {
      if(lazyloadThrottleTimeout) {
        clearTimeout(lazyloadThrottleTimeout);
      }    
      
      lazyloadThrottleTimeout = setTimeout(function() {
          var scrollTop = window.pageYOffset;
          lazyloadImages.forEach(function(img) {
              if(img.offsetTop < (window.innerHeight + scrollTop)) {
                img.src = img.dataset.src;
                img.classList.remove('lazy');
              }
          });
          if(lazyloadImages.length == 0) { 
            document.removeEventListener("scroll", lazyload);
            window.removeEventListener("resize", lazyload);
            window.removeEventListener("orientationChange", lazyload);
          }
      }, 300);
    }
    
    document.addEventListener("scroll", lazyload);
    window.addEventListener("resize", lazyload);
    window.addEventListener("orientationChange", lazyload);
  });

</script>

